!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(6)),a=r(n(7)),o=function(){function e(){}return e.getModule=function(){return this.module||(this.module=this.load()),this.module},e.load=function(){return a.default({locateFile:function(e){return e.endsWith(".wasm")?i.default:e},noInitialRun:!0})},e.getModulePromise=function(){var e=this.getModule();return new Promise((function(t,n){e.onRuntimeInitialized=function(){delete e.then,t(e)},e.onAbort=function(e){n(e)}}))},e}();t.WasmLoader=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(2);var r=n(0),i=n(8);r.WasmLoader.getModulePromise().then((function(e){console.log(e._add(3123112,2211234)),new i.ImageEditor}))},function(e,t,n){var r=n(3),i=n(4);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var a={insert:"head",singleton:!1},o=(r(i,a),i.locals?i.locals:{});e.exports=o},function(e,t,n){"use strict";var r,i=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},a=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),o=[];function u(e){for(var t=-1,n=0;n<o.length;n++)if(o[n].identifier===e){t=n;break}return t}function c(e,t){for(var n={},r=[],i=0;i<e.length;i++){var a=e[i],c=t.base?a[0]+t.base:a[0],l=n[c]||0,s="".concat(c," ").concat(l);n[c]=l+1;var f=u(s),d={css:a[1],media:a[2],sourceMap:a[3]};-1!==f?(o[f].references++,o[f].updater(d)):o.push({identifier:s,updater:p(d,t),references:1}),r.push(s)}return r}function l(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var i=n.nc;i&&(r.nonce=i)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var o=a(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var s,f=(s=[],function(e,t){return s[e]=t,s.filter(Boolean).join("\n")});function d(e,t,n,r){var i=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=f(t,i);else{var a=document.createTextNode(i),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(a,o[t]):e.appendChild(a)}}function h(e,t,n){var r=n.css,i=n.media,a=n.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),a&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var m=null,g=0;function p(e,t){var n,r,i;if(t.singleton){var a=g++;n=m||(m=l(t)),r=d.bind(null,n,a,!1),i=d.bind(null,n,a,!0)}else n=l(t),r=h.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=i());var n=c(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var i=u(n[r]);o[i].references--}for(var a=c(e,t),l=0;l<n.length;l++){var s=u(n[l]);0===o[s].references&&(o[s].updater(),o.splice(s,1))}n=a}}}},function(e,t,n){(t=n(5)(!1)).push([e.i,".image-container {\n  display: flex;\n  flex-wrap: wrap;\n}\n.image-container img {\n  margin: 2px;\n}\n.download-btn {\n  margin: 5px 0;\n}\n",""]),e.exports=t},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var i=(o=r,u=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(u),"/*# ".concat(c," */")),a=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[n].concat(a).concat([i]).join("\n")}var o,u,c;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(r)for(var a=0;a<this.length;a++){var o=this[a][0];null!=o&&(i[o]=!0)}for(var u=0;u<e.length;u++){var c=[].concat(e[u]);r&&i[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},function(e,t,n){"use strict";n.r(t),t.default=n.p+"2ce055fb23297854adbf68090b5f34d9.wasm"},function(e,t,n){var r,i=(r="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(e){var t,n=void 0!==(e=e||{})?e:{},i={};for(t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);var a,o=[],u=function(e,t){throw t},c="";document.currentScript&&(c=document.currentScript.src),r&&(c=r),c=0!==c.indexOf("blob:")?c.substr(0,c.lastIndexOf("/")+1):"";var l,s,f,d=n.print||console.log.bind(console),h=n.printErr||console.warn.bind(console);for(t in i)i.hasOwnProperty(t)&&(n[t]=i[t]);i=null,n.arguments&&(o=n.arguments),n.thisProgram&&n.thisProgram,n.quit&&(u=n.quit),n.wasmBinary&&(l=n.wasmBinary),n.noExitRuntime&&(s=n.noExitRuntime),"object"!=typeof WebAssembly&&h("no native wasm support detected");var m=new WebAssembly.Table({initial:4,maximum:4,element:"anyfunc"}),g=!1;function p(e,t){e||z("Assertion failed: "+t)}function y(e){var t=n["_"+e];return p(t,"Cannot call unknown function "+e+", make sure it is exported"),t}function v(e,t,n,r,i){var a={string:function(e){var t=0;if(null!=e&&0!==e){var n=1+(e.length<<2);!function(e,t,n){!function(e,t,n,r){if(!(r>0))return 0;for(var i=n+r-1,a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o>=55296&&o<=57343){var u=e.charCodeAt(++a);o=65536+((1023&o)<<10)|1023&u}if(o<=127){if(n>=i)break;t[n++]=o}else if(o<=2047){if(n+1>=i)break;t[n++]=192|o>>6,t[n++]=128|63&o}else if(o<=65535){if(n+2>=i)break;t[n++]=224|o>>12,t[n++]=128|o>>6&63,t[n++]=128|63&o}else{if(n+3>=i)break;t[n++]=240|o>>18,t[n++]=128|o>>12&63,t[n++]=128|o>>6&63,t[n++]=128|63&o}}t[n]=0}(e,_,t,n)}(e,t=$(n),n)}return t},array:function(e){var t=$(e.length);return function(e,t){b.set(e,t)}(e,t),t}},o=y(e),u=[],c=0;if(r)for(var l=0;l<r.length;l++){var s=a[n[l]];s?(0===c&&(c=Q()),u[l]=s(r[l])):u[l]=r[l]}var f=o.apply(null,u);return f=function(e){return"string"===t?E(e):"boolean"===t?Boolean(e):e}(f),0!==c&&ee(c),f}var w,b,_,x,S,I,A,R="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function C(e,t,n){for(var r=t+n,i=t;e[i]&&!(i>=r);)++i;if(i-t>16&&e.subarray&&R)return R.decode(e.subarray(t,i));for(var a="";t<i;){var o=e[t++];if(128&o){var u=63&e[t++];if(192!=(224&o)){var c=63&e[t++];if((o=224==(240&o)?(15&o)<<12|u<<6|c:(7&o)<<18|u<<12|c<<6|63&e[t++])<65536)a+=String.fromCharCode(o);else{var l=o-65536;a+=String.fromCharCode(55296|l>>10,56320|1023&l)}}else a+=String.fromCharCode((31&o)<<6|u)}else a+=String.fromCharCode(o)}return a}function E(e,t){return e?C(_,e,t):""}function P(e){w=e,n.HEAP8=b=new Int8Array(e),n.HEAP16=x=new Int16Array(e),n.HEAP32=S=new Int32Array(e),n.HEAPU8=_=new Uint8Array(e),n.HEAPU16=new Uint16Array(e),n.HEAPU32=new Uint32Array(e),n.HEAPF32=I=new Float32Array(e),n.HEAPF64=A=new Float64Array(e)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var M=2768,k=n.TOTAL_MEMORY||16777216;function D(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var r=t.func;"number"==typeof r?void 0===t.arg?n.dynCall_v(r):n.dynCall_vi(r,t.arg):r(void 0===t.arg?null:t.arg)}else t()}}(f=n.wasmMemory?n.wasmMemory:new WebAssembly.Memory({initial:k/65536}))&&(w=f.buffer),k=w.byteLength,P(w),S[M>>2]=5245808;var U=[],T=[],j=[],L=[];Math.abs,Math.ceil,Math.floor,Math.min;var W=0,O=null,H=null;function z(e){throw n.onAbort&&n.onAbort(e),d(e+=""),h(e),g=!0,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(e)}function B(e){return String.prototype.startsWith?e.startsWith("data:application/octet-stream;base64,"):0===e.indexOf("data:application/octet-stream;base64,")}n.preloadedImages={},n.preloadedAudios={};var F,Y="image-processor.wasm";function X(){try{if(l)return new Uint8Array(l);if(a)return a(Y);throw"both async and sync fetching of the wasm failed"}catch(e){z(e)}}function q(){return _.length}function N(e){try{return f.grow(e-w.byteLength+65535>>16),P(f.buffer),1}catch(e){}}B(Y)||(F=Y,Y=n.locateFile?n.locateFile(F,c):c+F),T.push({func:function(){K()}});var V={buffers:[null,[],[]],printChar:function(e,t){var n=V.buffers[e];0===t||10===t?((1===e?d:h)(C(n,0)),n.length=0):n.push(t)},varargs:0,get:function(e){return V.varargs+=4,S[V.varargs-4>>2]},getStr:function(){return E(V.get())},get64:function(){var e=V.get();return V.get(),e},getZero:function(){V.get()}},G={emscripten_get_sbrk_ptr:function(){return 2768},emscripten_memcpy_big:function(e,t,n){_.set(_.subarray(t,t+n),e)},emscripten_resize_heap:function(e){var t=q();if(e>2147418112)return!1;for(var n,r,i=1;i<=4;i*=2){var a=t*(1+.2/i);if(a=Math.min(a,e+100663296),N(Math.min(2147418112,((n=Math.max(16777216,e,a))%(r=65536)>0&&(n+=r-n%r),n))))return!0}return!1},fd_write:function(e,t,n,r){try{for(var i=0,a=0;a<n;a++){for(var o=S[t+8*a>>2],u=S[t+(8*a+4)>>2],c=0;c<u;c++)V.printChar(e,_[o+c]);i+=u}return S[r>>2]=i,0}catch(e){return"undefined"!=typeof FS&&e instanceof FS.ErrnoError||z(e),e.errno}},memory:f,setTempRet0:function(e){},table:m},J=function(){var e={env:G,wasi_snapshot_preview1:G};function t(e,t){var r=e.exports;n.asm=r,function(e){if(W--,n.monitorRunDependencies&&n.monitorRunDependencies(W),0==W&&(null!==O&&(clearInterval(O),O=null),H)){var t=H;H=null,t()}}()}function r(e){t(e.instance)}function i(t){return(l||"function"!=typeof fetch?new Promise((function(e,t){e(X())})):fetch(Y,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+Y+"'";return e.arrayBuffer()})).catch((function(){return X()}))).then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){h("failed to asynchronously prepare wasm: "+e),z(e)}))}if(W++,n.monitorRunDependencies&&n.monitorRunDependencies(W),n.instantiateWasm)try{return n.instantiateWasm(e,t)}catch(e){return h("Module.instantiateWasm callback failed with error: "+e),!1}return function(){if(l||"function"!=typeof WebAssembly.instantiateStreaming||B(Y)||"function"!=typeof fetch)return i(r);fetch(Y,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(r,(function(e){h("wasm streaming compile failed: "+e),h("falling back to ArrayBuffer instantiation"),i(r)}))}))}(),{}}();n.asm=J;var Z,K=n.___wasm_call_ctors=function(){return(K=n.___wasm_call_ctors=n.asm.__wasm_call_ctors).apply(null,arguments)},Q=(n._add=function(){return(n._add=n.asm.add).apply(null,arguments)},n._toGrayScale=function(){return(n._toGrayScale=n.asm.toGrayScale).apply(null,arguments)},n._resizeImage=function(){return(n._resizeImage=n.asm.resizeImage).apply(null,arguments)},n._rotateRight=function(){return(n._rotateRight=n.asm.rotateRight).apply(null,arguments)},n._malloc=function(){return(n._malloc=n.asm.malloc).apply(null,arguments)},n._rotateLeft=function(){return(n._rotateLeft=n.asm.rotateLeft).apply(null,arguments)},n._mirrorVertical=function(){return(n._mirrorVertical=n.asm.mirrorVertical).apply(null,arguments)},n._mirrorHorizontal=function(){return(n._mirrorHorizontal=n.asm.mirrorHorizontal).apply(null,arguments)},n._main=function(){return(n._main=n.asm.main).apply(null,arguments)},n.___errno_location=function(){return(n.___errno_location=n.asm.__errno_location).apply(null,arguments)},n._setThrew=function(){return(n._setThrew=n.asm.setThrew).apply(null,arguments)},n._free=function(){return(n._free=n.asm.free).apply(null,arguments)},n.stackSave=function(){return(Q=n.stackSave=n.asm.stackSave).apply(null,arguments)}),$=n.stackAlloc=function(){return($=n.stackAlloc=n.asm.stackAlloc).apply(null,arguments)},ee=n.stackRestore=function(){return(ee=n.stackRestore=n.asm.stackRestore).apply(null,arguments)};function te(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function ne(e){var t,r=n._main;try{t=r(0,0),!0&&s&&0===t||(s||(g=!0,n.onExit&&n.onExit(t)),u(t,new te(t)))}catch(e){if(e instanceof te)return;if("unwind"==e)return void(s=!0);var i=e;e&&"object"==typeof e&&e.stack&&(i=[e,e.stack]),h("exception thrown: "+i),u(1,e)}}function re(e){function t(){Z||(Z=!0,g||(D(T),D(j),n.onRuntimeInitialized&&n.onRuntimeInitialized(),ie&&ne(),function(){if(n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;)e=n.postRun.shift(),L.unshift(e);var e;D(L)}()))}e=e||o,W>0||(function(){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)e=n.preRun.shift(),U.unshift(e);var e;D(U)}(),W>0||(n.setStatus?(n.setStatus("Running..."),setTimeout((function(){setTimeout((function(){n.setStatus("")}),1),t()}),1)):t()))}if(n.__growWasmMemory=function(){return(n.__growWasmMemory=n.asm.__growWasmMemory).apply(null,arguments)},n.dynCall_ii=function(){return(n.dynCall_ii=n.asm.dynCall_ii).apply(null,arguments)},n.dynCall_iiii=function(){return(n.dynCall_iiii=n.asm.dynCall_iiii).apply(null,arguments)},n.dynCall_jiji=function(){return(n.dynCall_jiji=n.asm.dynCall_jiji).apply(null,arguments)},n.asm=J,n.cwrap=function(e,t,n,r){var i=(n=n||[]).every((function(e){return"number"===e}));return"string"!==t&&i&&!r?y(e):function(){return v(e,t,n,arguments)}},n.getValue=function(e,t,n){switch("*"===(t=t||"i8").charAt(t.length-1)&&(t="i32"),t){case"i1":case"i8":return b[e>>0];case"i16":return x[e>>1];case"i32":case"i64":return S[e>>2];case"float":return I[e>>2];case"double":return A[e>>3];default:z("invalid type for getValue: "+t)}return null},n.then=function(e){if(Z)e(n);else{var t=n.onRuntimeInitialized;n.onRuntimeInitialized=function(){t&&t(),e(n)}}return n},H=function e(){Z||re(),Z||(H=e)},n.run=re,n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();var ie=!0;return n.noInitialRun&&(ie=!1),s=!0,re(),e});e.exports=i},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function u(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,u)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(9),o=function(){function e(){var e=this;this.x=80,this.y=50,this.width=300,this.height=200,this.radius=8,this.isDragging=!1,this.isDraggingWindow=!1,this.imageX=0,this.imageY=0,this.imageScale=1;var t=document.getElementById("rotate90"),n=document.getElementById("rotate-90"),o=document.getElementById("mirror-v"),u=document.getElementById("mirror-h");o.onclick=function(){f=a.mirror(f,"V"),e.imageX=0,e.imageY=0,d=a.scaleImage(f,e.imageScale),e.draw(h,d)},u.onclick=function(){f=a.mirror(f,"H"),e.imageX=0,e.imageY=0,d=a.scaleImage(f,e.imageScale),e.draw(h,d)},t.onclick=function(){f=a.rotate(f,90),e.imageX=0,e.imageY=0,d=a.scaleImage(f,e.imageScale),e.draw(h,d)},n.onclick=function(){f=a.rotate(f,-90),e.imageX=0,e.imageY=0,d=a.scaleImage(f,e.imageScale),e.draw(h,d)},document.querySelector("#file-input").onchange=function(t){return r(e,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return e=t.target.files[0],n=URL.createObjectURL(e),[4,this.loadImage(n)];case 1:return f=r.sent(),d=a.scaleImage(f,this.imageScale),this.draw(h,d),[2]}}))}))};var c=document.getElementById("size"),l=document.getElementById("sliderValue"),s=document.createElement("canvas");document.querySelector(".download-btn").onclick=function(){var t=h.getImageData(e.x,e.y,e.width,e.height),n=document.createElement("canvas");n.width=e.width,n.height=e.height,n.getContext("2d").putImageData(t,0,0),a.download(n.toDataURL())},c.value="1",s.height=500,s.width=500,document.body.appendChild(s);var f,d,h=s.getContext("2d");c.oninput=function(t){var n=parseFloat(t.target.value);e.imageScale=n,l.textContent=n.toString(),console.log("input changed",n);var r=a.scaleImage(f,e.imageScale);r&&(d=r,e.draw(h,d),console.log("scaled"))},s.onmousedown=function(t){var n=s.offsetLeft,r=s.offsetTop,i=t.clientX-n,a=t.clientY-r,o=i>=e.x&&i<=e.x+e.width,u=a>=e.y&&a<=e.y+e.height;e.isDraggingWindow=o&&u,e.isDragging=!0,e.touchedX=i-(e.isDraggingWindow?e.x:e.imageX),e.touchedY=a-(e.isDraggingWindow?e.y:e.imageY)},s.onmouseup=function(){e.isDragging=!1,e.isDraggingWindow=!1},s.onmouseout=function(){e.isDragging=!1,e.isDraggingWindow=!1},s.onmousemove=function(t){var n=s.offsetLeft,r=s.offsetTop,i=t.clientX-n,a=t.clientY-r;if(e.isDragging)return!e.isDraggingWindow&&e.isDragging?(e.imageX=i-e.touchedX,e.imageY=a-e.touchedY,void e.draw(h,d)):e.isDraggingWindow?(e.x=i-e.touchedX,e.y=a-e.touchedY,void e.draw(h,d)):void 0},this.loadImage("images/image.jpg").then((function(t){f=t,d=a.scaleImage(f,e.imageScale),e.draw(h,d)}))}return e.prototype.loadImage=function(e){return r(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(i){switch(i.label){case 0:return(t=new Image).src=e,[4,u(t,"onload")];case 1:return i.sent(),u(t,"onerror").then((function(e){return console.log(e)})),(n=document.createElement("canvas")).width=t.width,n.height=t.height,(r=n.getContext("2d")).drawImage(t,0,0),[2,r.getImageData(0,0,t.width,t.height)]}}))}))},e.prototype.draw=function(e,t){e.clearRect(0,0,500,500),e.putImageData(t,this.imageX,this.imageY),e.beginPath(),e.globalAlpha=.7,e.fillStyle="black",e.fillRect(0,0,500,this.y),e.fillRect(0,this.y,this.x,500-this.y),e.fillRect(this.x,this.y+this.height,500-this.x,500-this.y-this.height),e.fillRect(this.x+this.width,this.y,500-this.x-this.width,this.height),e.beginPath(),e.strokeStyle="black",e.rect(this.x,this.y,this.width,this.height),e.lineWidth=3,e.stroke()},e.prototype.drawCircles=function(e){this.drawCircle(e,this.x,this.y),this.drawCircle(e,this.x,this.y+this.height),this.drawCircle(e,this.x+this.width,this.y),this.drawCircle(e,this.x+this.width,this.y+this.height)},e.prototype.drawCircle=function(e,t,n){var r=2*Math.PI;e.beginPath(),e.arc(t,n,this.radius,0,r),e.fillStyle="red",e.fill()},e}();function u(e,t){return new Promise((function(n,r){e[t]=function(e){console.log("loaded"),n(e)}}))}t.ImageEditor=o,t.eventPromise=u},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function u(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,u)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),o=function(){function e(){var e=this;document.querySelector("#file-input").onchange=function(t){var n=t.target.files[0];document.querySelectorAll(".image-container img").forEach((function(e){return e.remove()})),e.processFile(n)}}return e.prototype.processFile=function(e){var t=this,n=new FileReader;n.onload=function(e){var n=e.target.result;t.processImage(n)},n.onerror=function(e){return console.log("Hiba tortent",e)},n.readAsArrayBuffer(e)},e.prototype.processImage=function(e){return r(this,void 0,void 0,(function(){var t,n,r,o,u,l,s,f;return i(this,(function(i){switch(i.label){case 0:return t=a.WasmLoader.getModule(),[4,c(e)];case 1:n=i.sent(),r=n.rgbData,o=n.height,u=n.width;try{if(l=r.byteLength,s=t._malloc(l),t.HEAPU8.set(r,s),l!==u*o*4)return console.log("wrong size"),[2];t._toGrayScale(u,o,s,.299,.587,.114)||((f=new Uint8Array(l)).set(t.HEAPU8.subarray(s,s+l)),this.afterTransform(f,u,o)),t._free(s),t._free(l)}catch(e){console.log(e)}return[2]}}))}))},e.prototype.addToPreview=function(e,t){return new Promise((function(n,r){var i=document.createElement("img");i.src=e,i.className=t,i.style.display="none",i.onerror=function(e){console.log("error, failed to load image"),r(e)},i.onload=function(){i.style.display="block",console.log("loaded"),n(i)}}))},e.prototype.afterTransform=function(e,t,n){var r=document.createElement("canvas");r.width=t,r.height=n;var i=r.getContext("2d"),a=new ImageData(new Uint8ClampedArray(e),t,n);i.putImageData(a,0,0);var o=r.toDataURL();this.addToPreview(o,"transformed").then((function(e){document.querySelector(".transformed").appendChild(e)}));var c=document.querySelector(".download-btn");c.onclick=function(){u(o)},c.disabled=!1},e}();function u(e){var t=document.createElement("a");t.href=e,t.innerText="Download",t.download="transformed.png",t.style.display="none",document.body.appendChild(t),t.click(),t.remove()}function c(e){return new Promise((function(t,n){var r=new Uint8Array(e),i=new Blob([r],{type:"image/png"}),a=URL.createObjectURL(i),o=document.createElement("img");o.src=a,o.onerror=function(){console.log("error, failed to load image"),n()},o.onload=function(){var e=o.width,n=o.height;URL.revokeObjectURL(a);var r=document.createElement("canvas");r.width=e,r.height=n;var i=r.getContext("2d");i.drawImage(o,0,0),t({rgbData:i.getImageData(0,0,e,n).data,width:e,height:n})}}))}t.ImageTransformer=o,t.download=u,t.convertToRgbData=c,t.scaleImage=function(e,t){var n=e.data,r=e.width,i=e.height,o=a.WasmLoader.getModule();try{var u=Math.floor(r*t),c=Math.floor(i*t),l=u*c*4,s=n.byteLength,f=o._malloc(s),d=o._malloc(l);if(o.HEAPU8.set(n,f),s!==r*i*4)return void console.log("wrong size");o._resizeImage(r,i,f,d,t);var h=new Uint8Array(l);return h.set(o.HEAPU8.subarray(d,d+l)),o._free(f),o._free(d),new ImageData(new Uint8ClampedArray(h),u,c)}catch(e){console.log(e)}return null},t.rotate=function(e,t){var n=e.data,r=e.width,i=e.height,o=a.WasmLoader.getModule();try{var u=n.byteLength,c=o._malloc(u);if(o.HEAPU8.set(n,c),u!==r*i*4)return void console.log("wrong size");var l=i,s=r;(90===t?o._rotateRight:o._rotateLeft)(r,i,c);var f=new Uint8Array(u);return f.set(o.HEAPU8.subarray(c,c+u)),o._free(c),o._free(u),new ImageData(new Uint8ClampedArray(f),l,s)}catch(e){console.log(e)}return null},t.mirror=function(e,t){var n=e.data,r=e.width,i=e.height,o=a.WasmLoader.getModule();try{var u=n.byteLength,c=o._malloc(u);if(o.HEAPU8.set(n,c),u!==r*i*4)return void console.log("wrong size");("H"===t?o._mirrorHorizontal:o._mirrorVertical)(r,i,c);var l=new Uint8Array(u);return l.set(o.HEAPU8.subarray(c,c+u)),o._free(c),o._free(u),new ImageData(new Uint8ClampedArray(l),r,i)}catch(e){console.log(e)}return null}}]);